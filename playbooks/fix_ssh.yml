# =============================================================================
# Audit Event Identifier: DSU-PLY-100012
# Playbook Type: Remediation (SSH)
# Description: SSH hardening remediation playbook
# Last Updated: 2026-02-28
# Version: 1.0
# =============================================================================
---
# ISO 27001 ยง14.2 | Playbook Execution
- ansible.builtin.import_playbook: bootstrap_ssh.yml

- hosts: all
  become: true
  vars:
    # Enforce authoritative ssh policy
    sshd_permit_root_login: "no"
    sshd_password_authentication: "no"
    sshd_allow_x11_forwarding: false
    sshd_allow_tcp_forwarding: false
    sshd_allow_agent_forwarding: false
    # To enable limited exceptions for trusted groups, set these in inventory/group_vars
    sshd_enable_trusted_group_exceptions: false
    # sshd_trusted_groups: ['ssh-trusted']
  roles:
    - role: security/access
    - role: security/sshd

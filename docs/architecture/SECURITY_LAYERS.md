# Security Architecture: Defense-in-Depth

This document visualizes the 5-layer security model enforced by **Deploy-System-Unified**. Each layer must be successfully provisioned and verified before the next layer is applied.

```mermaid
graph BT
    subgraph "Layer 5: Edge & Ingress"
        L5[Caddy / CrowdSec] -->|WAF/IPS| Internet((Internet))
    end

    subgraph "Layer 4: Container Isolation"
        L4[Podman Quadlets] -->|Namespaces/Cgroups| L5
    end

    subgraph "Layer 3: User-Space Sandboxing"
        L3[Firejail / Bubblewrap] -->|Landlock/Seccomp| L4
    end

    subgraph "Layer 2: OS Hardening"
        L2[AppArmor / auditd / SSHD] -->|MAC/Forensics| L3
    end

    subgraph "Layer 1: Kernel & Firmware"
        L1[GRUB Hardening / Kernel Params] -->|Secure Boot| L2
    end

    style L1 fill:#fdd,stroke:#333,stroke-width:2px
    style L2 fill:#fbb,stroke:#333,stroke-width:2px
    style L3 fill:#f99,stroke:#333,stroke-width:2px
    style L4 fill:#f77,stroke:#333,stroke-width:2px
    style L5 fill:#f55,stroke:#333,stroke-width:4px
```

---

## üõ°Ô∏è The 5-Layer Model

| Layer | Roles Involved | Audit Event Identifier Range | Purpose |
|-------|----------------|-------------------|---------|
| **1. Kernel** | `security/kernel`, `core/grub` | `45xxxx` | Establish root of trust and memory protection. |
| **2. OS** | `security/hardening`, `security/sshd` | `40xxxx`, `51xxxx` | Attack surface reduction and forensic logging. |
| **3. Sandbox**| `security/sandboxing`, `security/firejail` | `41xxxx`, `42xxxx` | Restrict binary-level capabilities. |
| **4. Container**| `containers/runtime`, `containers/quadlets` | `7xxxxx` | Workload isolation and resource limits. |
| **5. Edge** | `containers/caddy`, `security/ips` | `54xxxx` | Real-time threat detection and reverse proxy. |

---

*Generated by DSU Architecture Creator*  
*Standard: ISO 27001 ¬ß8.20 (Network Security)*

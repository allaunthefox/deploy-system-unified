[defaults]
roles_path = ./roles
# Inventory: Use directory-based inventory (supports multiple files)
# Override with: ansible-playbook -i inventory/production.ini ...
# WARNING: Default points to local.ini - ensure you specify production inventory!
inventory = ./inventory/
# Vault password file - CI should set ANSIBLE_VAULT_PASSWORD_FILE env var to override
# For CI/lint workflows without vault: export ANSIBLE_VAULT_PASSWORD_FILE=/dev/null
vault_password_file = .vault_pass
# Use /var/tmp instead of /dev/shm for better security (world-readable tmpfs)
remote_tmp = /var/tmp/ansible
# Collections installed via ansible-galaxy collection install -r requirements.yml
collections_path = ~/.ansible/collections:/usr/share/ansible/collections
# SOPS Integration
vars_plugins_enabled = host_group_vars, community.sops.sops
deprecation_warnings = False
mnemonics_warnings = False
# Suppress internal collection warnings (protomatter is Ansible internal)
collections_warn_on_version_mismatch = False
# Resilience against network flapping
timeout = 60
callbacks_enabled = profile_tasks, timer
# Persistent logging for IDE session recovery (absolute path prevents accidental git commit)
log_path = /var/log/ansible/deploy-system-unified.log
local_tmp = /tmp/ansible

# Note: Deprecation warnings enabled to catch breaking changes during upgrades
# deprecation_warnings = True (default)

[ssh_connection]
# Reuse SSH connections (perf + stability)
pipelining = True
# Prefer SSH piped transfer to avoid SFTP/SCP dependency warnings
transfer_method = piped
# Persist connection for 60s to bridge small gaps
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o ServerAliveInterval=15 -o ServerAliveCountMax=4
# Retry connection establishment 3 times
retries = 3

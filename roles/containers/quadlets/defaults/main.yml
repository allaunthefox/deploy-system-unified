# =============================================================================
# Audit Event Identifier: DSU-PLY-100114
# Last Updated: 2026-02-28
# =============================================================================
---
# CIS Docker Benchmark | Pod Security Standards
# Defaults for containers/quadlets role
containers_quadlet_network_name: "{{ quadlet_network_name | default('deploy-net') }}"
containers_quadlet_create_network: "{{ quadlet_create_network | default(true) }}"
containers_quadlet_network_subnet: "{{ quadlet_network_subnet | default('10.89.0.0/24') }}"
containers_quadlet_network_gateway: "{{ quadlet_network_gateway | default('10.89.0.1') }}"
containers_quadlet_network_iprange: "{{ quadlet_network_iprange | default('10.89.0.0/24') }}"
containers_quadlet_custom_files: "{{ quadlet_custom_files | default([]) }}"
# Architecture override (explicit target architecture)
containers_quadlet_arch_override: "{{ quadlet_arch_override | default('') }}"
# GPU support for containers
containers_quadlet_enable_gpu_support: "{{ quadlet_enable_gpu_support | default(false) }}"
containers_quadlet_gpu_vendor: "{{ quadlet_gpu_vendor | default('nvidia') }}"  # Options: nvidia, amd, intel
containers_quadlet_gpu_devices: "{{ quadlet_gpu_devices | default([]) }}"  # List of specific GPU devices to passthrough (e.g., ["/dev/nvidia0", "/dev/nvidia1"])
containers_quadlet_gpu_capabilities: "{{ quadlet_gpu_capabilities | default([]) }}"  # Linux capabilities only (CAP_*). Leave empty unless required.
# GPU slicing configuration
containers_quadlet_gpu_slicing: >-
  {{ quadlet_gpu_slicing | default({
    'strategy': 'auto',
    'auto_strategy': {'bare_metal': 'mig', 'virtual_host': 'sriov', 'virtual_guest': 'passthrough'},
    'mig': {'enabled': false, 'profiles': ['1g.5gb']},
    'vgpu': {'enabled': false, 'profile': '', 'license_server': ''},
    'time_slicing': {'enabled': false, 'max_instances': 4},
    'sriov': {'enabled': false, 'vf_count': 4},
    'level_zero': {'enabled': false, 'partitions': []},
    'oneapi': {'enabled': false, 'toolkit': 'base', 'components': ['compiler','mpi','tbb']},
    'passthrough': {'devices': []}
  }) }}"
# Default GPU device configuration based on vendor
containers_quadlet_gpu_default_configs: >-
  {{ quadlet_gpu_default_configs | default({
    'nvidia': {
      'devices': ['/dev/nvidia0', '/dev/nvidiactl', '/dev/nvidia-uvm'],
      'mounts': ['/usr/bin/nvidia-smi:/usr/bin/nvidia-smi:ro', '/usr/lib/x86_64-linux-gnu/nvidia:/usr/lib/x86_64-linux-gnu/nvidia:ro'],
      'capabilities': []
    },
    'amd': {
      'devices': ['/dev/dri/card0', '/dev/dri/renderD128'],
      'mounts': ['/dev/dri:/dev/dri:rw', '/dev/kfd:/dev/kfd:rw'],
      'capabilities': []
    },
    'intel': {
      'devices': ['/dev/dri/card0', '/dev/dri/renderD128'],
      'mounts': ['/dev/dri:/dev/dri:rw'],
      'capabilities': []
    }
  }) }}"
# Container-specific GPU configurations
containers_quadlet_container_gpu_config: "{{ quadlet_container_gpu_config | default({}) }}"  # Key-value map of container names to GPU config

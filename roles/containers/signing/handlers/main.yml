# =============================================================================
# Audit Event Identifier: DSU-PLY-100157
# Last Updated: 2026-03-01
# =============================================================================
---
# Handlers for containers/signing role
# ISO 27001 ยง14.2 | NIST SI-3

- name: "ISO 27001 ยง14.2 | 700014 | sign_container_image"
  ansible.builtin.command:
    cmd: "cosign sign --key cosign.key {{ image_to_sign }}"
  when: signing_enabled | default(false) | bool
  listen: "sign container image"

- name: "ISO 27001 ยง14.2 | 700014 | verify_container_image"
  ansible.builtin.command:
    cmd: "cosign verify --key cosign.pub {{ image_to_verify }}"
  listen: "verify container image"

# =============================================================================
# Audit Event Identifier: DSU-TST-1000141
# Last Updated: 2026-02-28
# =============================================================================
---
# CIS Docker Benchmark | Pod Security Standards
- name: Verify
  hosts: all
  become: true
  gather_facts: false
  tasks:
    - name: Verify cosign directories exist
      ansible.builtin.file:
        path: "{{ item }}"
        state: directory
      loop:
        - /etc/cosign
        - /etc/cosign/keys
        - /etc/cosign/policies

    - name: Verify cosign integration is complete
      ansible.builtin.assert:
        that:
          - cosign_signing_complete | default(false) == true
        fail_msg: "Cosign signing was not completed"

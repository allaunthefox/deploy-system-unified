# =============================================================================
# Audit Event Identifier: DSU-PLY-100136
# Last Updated: 2026-02-28
# =============================================================================
---
# Install Cosign for supply chain integrity (ISO 27001 ยง14.2)

- name: "ISO 27001 ยง14.2 | Audit Code 530000 | Download Cosign binary"
  ansible.builtin.get_url:
    url: "https://github.com/sigstore/cosign/releases/download/v{{ containers_cosign_version }}/cosign-linux-{{ containers_cosign_arch }}"
    dest: "/usr/local/bin/cosign"
    mode: '0755'
    owner: root
    group: root
  become: true
  tags: [containers, runtime, supply_chain]

- name: "Audit Code 700014 | Verify Cosign Installation"
  ansible.builtin.command: cosign version
  register: cosign_verify
  changed_when: false
  tags: [containers, runtime, supply_chain, audit]

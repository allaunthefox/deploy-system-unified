---
- name: Create NVIDIA time-slicing configuration file
  tags: [containers, runtime, gpu, time_slicing]
  ansible.builtin.template:
    src: time_slicing_config.j2
    dest: /etc/nvidia-container-runtime/config.toml
    mode: '0644'
  become: true

- name: Restart containerd service (if running)
  tags: [containers, runtime, gpu, time_slicing]
  ansible.builtin.systemd:
    name: containerd
  tags: [containers, runtime, gpu, time_slicing]
    state: restarted
  become: true
  failed_when: false

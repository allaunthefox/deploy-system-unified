{# =============================================================================
# Audit Event Identifier: DSU-TPL-900012
# Template Type: runtime Configuration
# Last Updated: 2026-02-28
# Version: 1.0
# ============================================================================= #}
# NVIDIA MIG Configuration
# This file is automatically generated by Ansible

# MIG mode enabled
mig_enabled = {{ containers_gpu_slicing.mig.enabled }}

{% if containers_gpu_slicing.mig.enabled %}
# MIG profiles to create
mig_profiles = {{ containers_gpu_slicing.mig.profiles | default(['1g.5gb']) | to_json }}

# GPU device selectors
{% for device in containers_gpu_device_info %}
{% if device is search("NVIDIA") %}
device {{ loop.index0 }} {
  mig_enabled = true
  profiles = {{ containers_gpu_slicing.mig.profiles | default(['1g.5gb']) | to_json }}
}
{% endif %}
{% endfor %}
{% endif %}
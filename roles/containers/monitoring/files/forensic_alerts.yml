groups:
  - name: ForensicAlerts
    rules:
      - alert: SecurityBreakoutAttempt
        expr: count_over_time({job="varlogs"} |= "Audit Code 410101" [5m]) > 0
        for: 0m
        labels:
          severity: critical
          standard: ISO27001_8_26
        annotations:
          summary: "Forensic Alert: Container Breakout Attempt Detected"
          description: "Audit Event Identifier 410101 (Unauthorized breakout) detected in system logs on {{ $labels.instance }}."

      - alert: UnauthorizedAuditClear
        expr: count_over_time({job="varlogs"} |= "Audit Code 520003" [5m]) > 0
        for: 0m
        labels:
          severity: critical
          standard: ISO27037
        annotations:
          summary: "Forensic Alert: Audit Log Cleared"
          description: "Audit Event Identifier 520003 (LOG CLEARED) detected. Potential anti-forensic activity."

      - alert: SupplyChainViolation
        expr: count_over_time({job="varlogs"} |= "Audit Code 700015" [5m]) > 0
        for: 0m
        labels:
          severity: critical
          standard: ISO27001_14_2
        annotations:
          summary: "Forensic Alert: Untrusted Image Deployment"
          description: "Audit Event Identifier 700015 (UNTRUSTED IMAGE) detected. Signature verification failed."

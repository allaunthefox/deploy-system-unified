# =============================================================================
# Audit Event Identifier: DSU-PLY-100071
# Last Updated: 2026-02-28
# =============================================================================
# Internal variables for containers/config role
# Container storage and system configuration

# =============================================================================
# COMPLIANCE MAPPINGS - CIS, STIG, NIST, ISO 27001
# =============================================================================
# Role: containers/config
# Standards: CIS Docker Benchmark 3.x, STIG V-230420,
#            NIST SC-39/CM-6, ISO 27001 ยง8.20
# =============================================================================
---

_compliance_framework:
  cis_docker_benchmark:
    version: "3.x"
    description: "Container Configuration Security"
    controls:
      - id: "3.1"
        name: "Container storage directories"
        stig: "V-230420"
        nist: ["CM-6"]
      - id: "3.2"
        name: "Container storage configuration"
        stig: "V-230420"
        nist: ["SC-39"]
        iso: "8.20"
      - id: "3.3"
        name: "Container lingering status check"
        stig: "V-230420"
        nist: ["CM-6"]
      - id: "3.4"
        name: "Container lingering for service users"
        stig: "V-230420"
        nist: ["CM-6"]
        iso: "9.2"
  stig:
    container_config:
      - id: "V-230420"
        title: "Container Configuration Security"
        severity: "medium"
  nist:
    sc_39: "Protection of Information at Rest"
    cm_6: "Configuration Settings"
  iso_27001:
    "8.20": "Networks Security"
    "9.2": "User Access Management"

# Storage configuration paths
_config_storage_base: /var/lib/containers
_config_storage_graph: /var/lib/containers/storage
_config_storage_runroot: /run/containers/storage
_config_storage_overlay_dir: /var/lib/containers/storage/overlay

# Container data directories
_config_srv_containers: /srv/containers
_config_srv_volumes: /srv/containers/volumes
_config_srv_configs: /srv/containers/configs
_config_srv_secrets: /srv/containers/secrets
_config_srv_logs: /srv/containers/logs

# Configuration file paths
_config_storage_conf: /etc/containers/storage.conf
_config_containers_conf: /etc/containers/containers.conf
_config_registry_conf: /etc/containers/registries.conf
_config_policy_conf: /etc/containers/policy.json
_config_mounts_conf: /etc/containers/mounts.conf

# Storage driver configuration
_config_storage_driver: overlay
_config_storage_driver_options:
  - nodev
  - metacopy=on

# Registry mirrors and pull policies
_config_registry_mirrors:
  - docker.io
_config_registry_insecure: []
_config_registry_search:
  - docker.io
  - quay.io
  - ghcr.io

# Image pull configuration
_config_pull_retries: 5
_config_pull_delay: 30
_config_pull_timeout: 300

# Systemd linger configuration
_config_linger_service: systemd-logind
_config_linger_command: loginctl

# Secrets management
_config_secrets_driver: file
_config_secrets_opts: /etc/containers/secrets

# Logging configuration
_config_log_driver: journald
_config_log_size_max: 10m
_config_log_file_max: 5
_config_log_rotate_period: 720h

# Network configuration defaults
_config_cni_config_dir: /etc/cni/net.d
_config_netavark_config_dir: /etc/containers/networks

# Security profiles
_config_seccomp_default: /usr/share/containers/seccomp.json
_config_apparmor_default: /etc/apparmor.d/podman-default

# Checkpoint directory
_config_checkpoint_dir: /var/lib/deploy-system/checkpoints
_config_checkpoint_file: config_checkpoint.json

# =============================================================================
# Audit Event Identifier: DSU-PLY-100061
# Last Updated: 2026-02-28
# =============================================================================
# Goss tests for containers/common role
# ISO 27001 ยง8.26 - Container security

# =============================================================================
# PACKAGE TESTS
# =============================================================================
package:
  podman:
    installed: true

# =============================================================================
# DIRECTORY TESTS
# =============================================================================
file:
  /srv/containers:
    exists: true
    filetype: directory
    mode: "0755"

  /etc/containers/systemd:
    exists: true
    filetype: directory
    mode: "0755"

# =============================================================================
# COMMAND TESTS
# =============================================================================
command:
  podman_version:
    exec: 'podman version'
    exit-status: 0
    timeout: 10000

  podman_info:
    exec: 'podman info'
    exit-status: 0
    timeout: 10000

  podman_networks:
    exec: 'podman network ls'
    exit-status: 0
    timeout: 10000

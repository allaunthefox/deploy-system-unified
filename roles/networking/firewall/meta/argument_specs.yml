# =============================================================================
# Audit Event Identifier: DSU-ARG-100200
# Last Updated: 2026-03-01
# =============================================================================
---
argument_specs:
  main:
    short_description: Host-level firewall management and boundary protection
    description:
      - This role manages the system firewall (UFW or NFTables) to enforce network boundary protection and port isolation.
    options:
      networking_firewall_enabled:
        type: bool
        default: true
        description: Master toggle for the firewall role.
      networking_firewall_allowed_tcp_ports:
        type: list
        elements: int
        description: List of TCP ports to allow through the firewall.
      networking_firewall_allow_endlessh:
        type: bool
        description: Whether to explicitly open the port for the Endlessh honeytrap.
      networking_firewall_endlessh_port:
        type: int
        default: 22
        description: The port used by Endlessh.
      networking_firewall_allowed_udp_ports:
        type: list
        elements: int
        default: []
        description: List of UDP ports to allow through the firewall.
      networking_firewall_additional_rules:
        type: list
        elements: dict
        default: []
        description: Granular rules defining port, protocol, source CIDR, and comments.
      networking_firewall_forward_policy:
        type: str
        default: "DROP"
        choices: ["DROP", "ACCEPT", "REJECT"]
        description: Default policy for forwarded traffic.

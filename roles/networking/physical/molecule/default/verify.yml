# =============================================================================
# Audit Event Identifier: DSU-TST-1000571
# Last Updated: 2026-02-28
# =============================================================================
---
# RFC Compliance | ISO 27001 ยง13.1
- name: Verify
  hosts: all
  gather_facts: false
  tasks:
    - name: Check if ethtool binary exists
      ansible.builtin.stat:
        path: /sbin/ethtool
      register: ethtool_bin
      failed_when: false

    - name: Check /usr/sbin/ethtool if /sbin failed
      ansible.builtin.stat:
        path: /usr/sbin/ethtool
      register: ethtool_bin_usr
      when: ethtool_bin.stat.exists == false

    - name: Assert ethtool installed
      ansible.builtin.assert:
        that: ethtool_bin.stat.exists or ethtool_bin_usr.stat.exists

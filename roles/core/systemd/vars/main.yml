---
# Internal variables for core/systemd role
# Systemd configuration and hardening
# CIS 5.2.x, 5.3.x | STIG V-230260, V-230261 | NIST AU-2, AU-3, AU-12, CM-6 | ISO 27001 §12.4, §8.26

# Role metadata
core_systemd_role_version: "1.0.0"

# Configuration file paths
core_systemd_journald_config: "/etc/systemd/journald.conf"
core_systemd_resolved_config: "/etc/systemd/resolved.conf"
core_systemd_logind_config: "/etc/systemd/logind.conf"
core_systemd_system_config_dir: "/etc/systemd/system"

# Journald configuration defaults
core_systemd_journald_settings:
  Storage: "persistent"
  Compress: "yes"
  SystemMaxUse: "500M"
  SystemMaxFileSize: "50M"
  SystemKeepFree: "1G"
  SystemMaxFiles: "100"
  RuntimeMaxUse: "100M"
  RuntimeMaxFileSize: "10M"
  RuntimeKeepFree: "500M"
  RuntimeMaxFiles: "50"

# Resolved configuration defaults
core_systemd_resolved_settings:
  DNS: "1.1.1.1 9.9.9.9"
  FallbackDNS: "8.8.8.8"
  DNSSEC: "allow-downgrade"
  DNSOverTLS: "opportunistic"
  DNSStubListener: "yes"
  ReadEtcHosts: "yes"

# Journal directory paths
core_systemd_journal_dirs:
  persistent: "/var/log/journal"
  runtime: "/run/log/journal"

# Journal directory permissions
core_systemd_journal_dir_mode: "2755"
core_systemd_journal_owner: "root"
core_systemd_journal_group: "systemd-journal"

# Handler names
core_systemd_handlers:
  - "restart_journald"
  - "restart_resolved"
  - "reload_systemd"

# ISO 27001 compliance references
core_systemd_iso_controls:
  journald: "ISO 27001 §12.4"
  resolved: "ISO 27001 §9.4"
core_systemd_action_codes:
  journald: "840030"
  resolved: "810300"

# Service manager requirement
core_systemd_required_manager: "systemd"

# Compliance mappings
core_systemd_compliance:
  cis:
    - "CIS 5.2.1"
    - "CIS 5.2.4"
    - "CIS 5.3.1"
  stig:
    - "V-230260"
    - "V-230261"
  nist:
    - "AU-2"
    - "AU-3"
    - "AU-12"
    - "CM-6"
  iso_27001:
    - "§12.4"
    - "§8.26"
    - "§9.4"

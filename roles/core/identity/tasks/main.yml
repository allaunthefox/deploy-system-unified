# =============================================================================
# Audit Event Identifier: DSU-PLY-100445
# Last Updated: 2026-02-28
# =============================================================================
---
# Tasks for core/identity - Entropy-Backed UUID Generation
# CIS 5.1.x | STIG V-230340 | NIST IA-2, IA-3 | ISO 27001 ยง9.2

- name: "CIS 5.1.1 | STIG V-230340 | NIST IA-2 | ISO 27001 ยง9.2 | ISO 8000-110 | Audit Code 400011 | Generate high-entropy UUID for virtualization object"
  ansible.builtin.shell: |
    cat /proc/sys/kernel/random/uuid
  register: generated_uuid_output
  changed_when: false
  tags:
    - cis_5_1_1
    - stig_v_230340
    - nist_ia_2
    - iso_27001_9_2
    - iso_8000
    - identity
    - forensics

- name: "CIS 5.1.1 | STIG V-230340 | NIST IA-2 | Set object identity fact"
  ansible.builtin.set_fact:
    object_uuid: "{{ generated_uuid_output.stdout }}"
  tags:
    - cis_5_1_1
    - stig_v_230340
    - nist_ia_2
    - identity

- name: "CIS 5.1.1 | STIG V-230340 | NIST IA-2 | ISO 27001 ยง9.2 | Report generated identity"
  ansible.builtin.debug:
    msg: "Object successfully assigned high-entropy UUID: {{ object_uuid }}"
  tags:
    - cis_5_1_1
    - stig_v_230340
    - nist_ia_2
    - iso_27001_9_2
    - identity

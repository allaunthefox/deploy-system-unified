# =============================================================================
# Audit Event Identifier: DSU-PLY-100413
# Last Updated: 2026-02-28
# =============================================================================
---
# NIST SP 800-53 CM-5 | ISO 27001 ยง12.1
# Handlers for core/entropy role

- name: "ISO 9001 | 600013 | restart_haveged"
  ansible.builtin.systemd:
    name: haveged
    state: restarted
  become: true
  listen: "restart haveged"
  when: ansible_service_mgr == 'systemd'
  failed_when: false

- name: "ISO 9001 | 600013 | restart_rngd"
  ansible.builtin.systemd:
    name: rngd
    state: restarted
  become: true
  listen: "restart rngd"
  when: ansible_service_mgr == 'systemd'
  failed_when: false

- name: "ISO 9001 | 600013 | restart_rng_tools_debian"
  ansible.builtin.systemd:
    name: rng-tools-debian
    state: restarted
  become: true
  listen: "restart rng-tools"
  when:
    - ansible_os_family == 'Debian'
    - ansible_service_mgr == 'systemd'
  failed_when: false

- name: "ISO 9001 | 600013 | restart_rng_tools_redhat"
  ansible.builtin.systemd:
    name: rngd
    state: restarted
  become: true
  listen: "restart rng-tools"
  when:
    - ansible_os_family == 'RedHat'
    - ansible_service_mgr == 'systemd'
  failed_when: false

- name: "ISO 9001 | 600013 | restart_jitterentropy"
  ansible.builtin.systemd:
    name: jitterentropy-rngd
    state: restarted
  become: true
  listen: "restart jitterentropy"
  when: ansible_service_mgr == 'systemd'
  failed_when: false

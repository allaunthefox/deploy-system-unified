# Goss tests for core/repositories role
# CIS 3.3.x | STIG V-230320 | NIST SI-2, CM-2 | ISO 27001 ยง8.9
---
package:
  gnupg:
    installed: true
  ca-certificates:
    installed: true

# Verify apt sources exist (Debian/Ubuntu)
file:
  /etc/apt/sources.list:
    exists: true
  /etc/apt/sources.list.d:
    exists: true
    is-dir: true

command:
  # Verify package cache can be updated
  apt-get update:
    exit-status: 0
    timeout: 30000

# For RPM-based systems
file:
  /etc/yum.repos.d:
    exists: true
    is-dir: true

# =============================================================================
# Audit Event Identifier: DSU-PLY-100496
# Last Updated: 2026-02-28
# =============================================================================
---
# NIST SP 800-53 CM-5 | ISO 27001 ยง12.1
# Handlers for core/updates role
# Note: Automatic update services are self-managing and do not require explicit restart handlers
# unattended-upgrades (Debian/Ubuntu) and dnf-automatic (RedHat/Fedora) are timer-based services

- name: restart_unattended_upgrades
  ansible.builtin.systemd:
    name: unattended-upgrades
    state: restarted
  become: true
  listen: "restart unattended-upgrades"
  when:
    - ansible_os_family == 'Debian'
    - ansible_service_mgr == 'systemd'

- name: restart_dnf_automatic
  ansible.builtin.systemd:
    name: dnf-automatic.timer
    state: restarted
  become: true
  listen: "restart dnf-automatic"
  when:
    - ansible_os_family == 'RedHat'
    - ansible_service_mgr == 'systemd'

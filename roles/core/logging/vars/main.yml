---
# Internal variables for core/logging role
# Mandatory forensic readiness logging configuration
# CIS 4.2.x | STIG V-230330 | NIST AU-2, AU-3, AU-12 | ISO 27001 ยง12.4

# Role metadata
core_logging_role_version: "1.0.0"

# Package mapping for systemd journal remote
core_logging_journal_remote_packages:
  archlinux: "systemd"
  debian: "systemd-journal-remote"
  ubuntu: "systemd-journal-remote"
  fedora: "systemd-journal-remote"
  centos: "systemd-journal-remote"
  rocky: "systemd-journal-remote"
  almalinux: "systemd-journal-remote"
  alpine: "rsyslog"

# Configuration file paths
core_logging_journald_config: "/etc/systemd/journald.conf"
core_logging_rsyslog_config_dir: "/etc/rsyslog.d"
core_logging_rsyslog_central_config: "/etc/rsyslog.d/50-centralized-logging.conf"
core_logging_logrotate_config: "/etc/logrotate.d/applications"

# Journald directory paths
core_logging_journal_dirs:
  persistent: "/var/log/journal"
  runtime: "/run/log/journal"

# Default rate limiting settings
core_logging_rate_limit_interval: "30s"
core_logging_rate_limit_burst: "1000"

# Default retention settings
core_logging_max_file_sec: "1day"
core_logging_max_retention_sec: "30day"

# Journald configuration defaults
core_logging_journald_settings:
  Storage: "persistent"
  Compress: "yes"
  Seal: "yes"
  ForwardToSyslog: "yes"
  RateLimitIntervalSec: "{{ core_logging_rate_limit_interval }}"
  RateLimitBurst: "{{ core_logging_rate_limit_burst }}"
  MaxFileSec: "{{ core_logging_max_file_sec }}"
  MaxRetentionSec: "{{ core_logging_max_retention_sec }}"

# Log rotation settings
core_logging_logrotate_defaults:
  frequency: "daily"
  rotate_count: 30
  compress: true
  delaycompress: true
  missingok: true
  notifempty: true
  create_mode: "0644"
  create_owner: "root"
  create_group: "root"

# Handler names
core_logging_handlers:
  - "restart_journald"
  - "restart_rsyslog"

# ISO 27001 compliance references
core_logging_iso_controls:
  - "ISO 27001 ยง12.4"
  - "ISO 27037"
  - "NIST AU-2"
core_logging_action_codes:
  journald: "840030"
  rsyslog: "840031"

# Verification commands
core_logging_verify_command: "journalctl --verify"

# Compliance mappings
core_logging_compliance:
  cis:
    - "CIS 4.2.1"
    - "CIS 4.2.2"
    - "CIS 4.2.3"
  stig:
    - "V-230330"
  nist:
    - "AU-2"
    - "AU-3"
    - "AU-12"
  iso_27001:
    - "ยง12.4"

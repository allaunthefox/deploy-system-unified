# Goss tests for core/secrets role
# CIS 5.5.x | STIG V-230290 | NIST IA-5, SC-12, SC-28 | ISO 27001 ยง8.24
---
file:
  # Secrets directory should exist with restricted permissions
  /etc/ansible/secrets:
    exists: true
    is-dir: true
    mode: "0700"
    owner: root
    group: root

command:
  # Verify directory is accessible only by root
  stat -c "%a" /etc/ansible/secrets:
    exit-status: 0
    stdout:
      - "700"

---
# Tasks for core/secrets - Secrets Management & Integrity
# This role handles secure secret deployment with built-in integrity verification

- name: "ISO 27001 ยง10.1 | Action 400010 | Ensure secrets directory exists"
  ansible.builtin.file:
    path: /etc/ansible/secrets
    state: directory
    mode: '0700'
    owner: root
    group: root
  become: true
  tags:
    - iso_27001_10_1
    - secrets
    - security

- name: "ISO 27001 ยง10.1 | Action 400011 | Deploy secrets from vault"
  ansible.builtin.debug:
    msg: "Secrets deployment handled via Ansible Vault - no additional tasks required"
  when: core_secrets_enabled | default(true)
  tags:
    - iso_27001_10_1
    - secrets
    - security

- name: Perform Secret Archival Integrity Checks
  ansible.builtin.include_tasks: archival_integrity.yml
  when: core_secrets_enabled | default(true)
  tags: [secrets, archival, forensic]

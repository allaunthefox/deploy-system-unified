# =============================================================================
# Audit Event Identifier: DSU-PLY-100479
# Last Updated: 2026-02-28
# =============================================================================
---
# Internal variables for core/secrets role
# Secrets management and integrity verification
# CIS 5.5.x | STIG V-230290 | NIST IA-5, SC-12, SC-28 | ISO 27001 ยง8.24

# Role metadata
core_secrets_role_version: "1.0.0"

# Directory paths
core_secrets_base_dir: "/etc/ansible/secrets"
core_secrets_vault_dir: "/etc/ansible/secrets/vault"
core_secrets_archive_dir: "/etc/ansible/secrets/archive"

# SOPS configuration paths
core_secrets_sops_config_dir: "{{ lookup('env', 'HOME') }}/.config/sops"
core_secrets_sops_age_key_path: "{{ lookup('env', 'HOME') }}/.config/sops/age/keys.txt"
core_secrets_sops_config_path: "{{ lookup('env', 'HOME') }}/.config/sops/config.yaml"

# Integrity verification settings
core_secrets_hash_algorithms:
  - "sha256"
  - "sha512"
  - "blake3"

# PQC (Post-Quantum Cryptography) readiness
core_secrets_pqc_min_age_version: "1.3.0"
core_secrets_pqc_ml_kem_support: false

# Archival configuration
core_secrets_archival_enabled: true
core_secrets_archival_repos_path: "/var/backups/secrets-archival"

# File permissions
core_secrets_dir_mode: "0700"
core_secrets_file_mode: "0600"
core_secrets_owner: "root"
core_secrets_group: "root"

# Compliance mappings
core_secrets_compliance:
  cis:
    - "CIS 5.5.1"
  stig:
    - "V-230290"
  nist:
    - "IA-5"
    - "SC-12"
    - "SC-28"
  iso_27001:
    - "ยง8.24"

# =============================================================================
# Audit Event Identifier: DSU-PLY-100420
# Last Updated: 2026-02-28
# =============================================================================
---
# NIST SP 800-53 CM-5 | ISO 27001 ยง12.1
# Handlers for core/grub

- name: update_grub
  ansible.builtin.command: update-grub
  become: true
  changed_when: true
  when: ansible_os_family == 'Debian'

- name: update_grub_redhat
  ansible.builtin.command: grub2-mkconfig -o /boot/grub2/grub.cfg
  become: true
  changed_when: true
  when: ansible_os_family == 'RedHat'
  listen: update-grub

- name: update_grub_arch_alpine
  ansible.builtin.command: grub-mkconfig -o /boot/grub/grub.cfg
  become: true
  changed_when: true
  when: ansible_os_family in ['Archlinux', 'Alpine']
  listen: update-grub

# =============================================================================
# Audit Event Identifier: DSU-PLY-100436
# Last Updated: 2026-02-28
# =============================================================================
---
# NIST SP 800-53 CM-5 | ISO 27001 ยง12.1
# aarch64 specific hardware tasks

- name: Set Hardware Facts (aarch64)
  tags: [core, hardware, audit]
  ansible.builtin.set_fact:
    host_cpu_has_avx: false
    host_cpu_has_avx2: false
    host_cpu_has_sse4_2: false
    host_cpu_has_aes: "{{ 'aes' in ansible_facts['processor_features'] | default([]) }}"
    host_cpu_has_sha: "{{ 'sha1' in ansible_facts['processor_features'] | default([]) or 'sha2' in ansible_facts['processor_features'] | default([]) }}"
    host_cpu_has_rdrand: false
    host_has_qat: false
    host_has_hardware_rng: false # ARM uses different mechanisms for RNG usually

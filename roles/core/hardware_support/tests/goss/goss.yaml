# Goss tests for core/hardware_support role
# ISO 9001 | ISO 27001 ยง8.17 | ISO 27001 ยง10.1
---
command:
  # Verify CPU info is available
  lscpu:
    exit-status: 0
  # Verify hardware clock can be queried
  hwclock:
    exit-status: 0

file:
  # Check for CPU feature files
  /proc/cpuinfo:
    exists: true
  # Check for hardware RNG device
  /dev/hwrng:
    exists: true
  # Check for timedatectl
  /usr/bin/timedatectl:
    exists: true

# Note: Actual CPU feature checks (AVX, AES-NI) require lscpu parsing
# which is done at Ansible runtime, not at Goss test time

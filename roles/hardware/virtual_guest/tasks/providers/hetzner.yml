# =============================================================================
# Audit Event Identifier: DSU-PLY-100566
# Last Updated: 2026-02-28
# =============================================================================
---
# ISO 27001 ยง11.1 | Physical Security
# Tasks for Hetzner-specific VPS optimization
# Based on research: Protects /32 point-to-point routing connectivity
- name: Verify Hetzner Point-to-Point routing
  ansible.builtin.shell: |
    ip addr show | grep -q "/32"
  register: hetzner_32_check
  failed_when: false
  changed_when: false
  args:
    
- name: Report Hetzner Routing Status
  ansible.builtin.debug:
    msg: "Hetzner /32 networking detected. Ensuring routing table persistence."
  when: hetzner_32_check.rc == 0
- name: Apply Hetzner-specific sysctl optimizations
  ansible.posix.sysctl:
    name: net.ipv4.conf.all.send_redirects
    value: '0'
    state: present
    sysctl_file: /etc/sysctl.d/99-hetzner-optimization.conf
    reload: true
  become: true
  tags: [hardware,virtualization,remediate]

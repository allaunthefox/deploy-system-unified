---
- name: Create
  hosts: localhost
  connection: local
  gather_facts: false
  tasks:
    - name: Create resource_protection test containers
      containers.podman.podman_container:
        name: "{{ item.name }}"
        image: "{{ item.image }}"
        command: "{{ item.command | default('/lib/systemd/systemd') }}"
        privileged: true
        volumes:
          - /sys/fs/cgroup:/sys/fs/cgroup:rw
        tmpfs:
          /run: "rw"
          /tmp: "rw"
        state: started
      loop:
        - { name: 'resource-protection-ubuntu-2204', image: 'docker.io/geerlingguy/docker-ubuntu2204-ansible:latest', command: '/lib/systemd/systemd' }
        - { name: 'resource-protection-debian-12', image: 'docker.io/geerlingguy/docker-debian12-ansible:latest', command: '/lib/systemd/systemd' }
        - { name: 'resource-protection-alpine-319', image: 'docker.io/geerlingguy/docker-alpine319-ansible:latest', command: '/sbin/init' }
        - { name: 'resource-protection-rockylinux-9', image: 'docker.io/geerlingguy/docker-rockylinux9-ansible:latest', command: '/usr/lib/systemd/systemd' }

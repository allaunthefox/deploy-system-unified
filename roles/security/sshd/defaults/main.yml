---
# Defaults for security/sshd role
security_sshd_backup_config: true
security_sshd_disable_weak_keys: false
security_sshd_use_strong_ciphers: true
security_sshd_allow_tcp_forwarding: false
security_sshd_allow_agent_forwarding: false
security_sshd_allow_x11_forwarding: false
# Authoritative policy: disable root SSH login by default
# CIS 5.2.5 | ISO 27001 ยง9.2
security_sshd_permit_root_login: "no"
# CIS 5.2.11 | ISO 27001 ยง9.2
security_sshd_password_authentication: "no"
# Post-Quantum Cryptography (PQC) support (Hybrid Mode)
# Enables sntrup761 and ML-KEM algorithms where supported by OpenSSH
security_sshd_pqc_enabled: "{{ system_ssh_pqc_enabled | default(true) }}"
# Path to sshd config file (useful for testing with a temporary path)
security_sshd_config_path: "/etc/ssh/sshd_config"
# Trusted groups for limited exceptions (agent/tcp forwarding)
# - Set sshd_enable_trusted_group_exceptions: true to enable
# - Populate sshd_trusted_groups with group names (e.g., ['ssh-trusted'])
security_sshd_enable_trusted_group_exceptions: false
security_sshd_trusted_groups: []

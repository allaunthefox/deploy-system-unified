# =============================================================================
# Audit Event Identifier: DSU-PLY-120001
# File Type: Role Defaults (main.yml)
# Role: sshd
# Last Updated: 2026-02-28
# Version: 1.0
# =============================================================================
---
# Defaults for security/sshd role
security_sshd_backup_config: true
security_sshd_disable_weak_keys: true  # CRITICAL: Remove weak DSA/ECDSA keys by default
security_sshd_use_strong_ciphers: true
security_sshd_allow_tcp_forwarding: false
security_sshd_allow_agent_forwarding: false
security_sshd_allow_x11_forwarding: false
# Authoritative policy: disable root SSH login by default
# CIS 5.2.5 | ISO 27001 ยง9.2
security_sshd_permit_root_login: "no"
# CIS 5.2.11 | ISO 27001 ยง9.2
security_sshd_password_authentication: "no"
# Idle Timeout Settings (CIS 5.2.23)
security_sshd_client_alive_interval: 300
security_sshd_client_alive_count_max: 2

# Post-Quantum Cryptography (PQC) support (Hybrid Mode)
# Enables sntrup761 and ML-KEM algorithms where supported by OpenSSH
security_sshd_pqc_enabled: "{{ system_ssh_pqc_enabled | default(true) }}"
# Path to sshd config file - uses sshd_config.d drop-in for modern systems
# Falls back to /etc/ssh/sshd_config for older systems without config.d support
security_sshd_config_path: "/etc/ssh/sshd_config.d/99-hardened.conf"
security_sshd_config_fallback_path: "/etc/ssh/sshd_config"
# Trusted groups for limited exceptions (agent/tcp forwarding)
# - Set sshd_enable_trusted_group_exceptions: true to enable
# - Populate sshd_trusted_groups with group names (e.g., ['ssh-trusted'])
security_sshd_enable_trusted_group_exceptions: false
security_sshd_trusted_groups: []

# PQC KEX algorithms (computed at runtime based on OpenSSH version)
security_sshd_kex_algorithms_pqc: []

# =============================================================================
# Audit Event Identifier: DSU-ARG-100385
# Last Updated: 2026-03-01
# =============================================================================
---
argument_specs:
  main:
    short_description: SSH daemon hardening with strong cryptography
    description:
      - This role hardens the OpenSSH daemon by enforcing strong ciphers, disabling password authentication, and implementing Post-Quantum Cryptography (PQC) where supported.
    options:
      security_sshd_backup_config:
        type: bool
        default: true
        description: Whether to back up the existing sshd_config before applying changes.
      security_sshd_disable_weak_keys:
        type: bool
        default: true
        description: Remove weak host keys (DSA, ECDSA) and maintain only RSA/ED25519.
      security_sshd_use_strong_ciphers:
        type: bool
        default: true
        description: Enforce high-entropy ciphers and MACs.
      security_sshd_allow_tcp_forwarding:
        type: bool
        default: false
        description: Enable or disable SSH TCP forwarding.
      security_sshd_allow_agent_forwarding:
        type: bool
        default: false
        description: Enable or disable SSH agent forwarding.
      security_sshd_allow_x11_forwarding:
        type: bool
        default: false
        description: Enable or disable X11 forwarding.
      security_sshd_permit_root_login:
        type: str
        default: "no"
        choices: ["yes", "no", "prohibit-password", "forced-commands-only"]
        description: Configure PermitRootLogin policy.
      security_sshd_password_authentication:
        type: str
        default: "no"
        choices: ["yes", "no"]
        description: Configure PasswordAuthentication policy.
      security_sshd_pqc_enabled:
        type: bool
        default: true
        description: Enable Post-Quantum Cryptography (PQC) hybrid key exchange.
      security_sshd_config_path:
        type: str
        default: "/etc/ssh/sshd_config.d/99-hardened.conf"
        description: Primary path for the hardened configuration drop-in.
      security_sshd_config_fallback_path:
        type: str
        default: "/etc/ssh/sshd_config"
        description: Fallback path for systems without sshd_config.d support.
      security_sshd_enable_trusted_group_exceptions:
        type: bool
        default: false
        description: Allow certain hardening bypasses for specific user groups.
      security_sshd_trusted_groups:
        type: list
        elements: str
        default: []
        description: List of system groups exempt from strict forwarding restrictions.

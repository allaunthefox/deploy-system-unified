---
# Handlers for security/sshd role
- name: Restart SSHD
  block:
    - name: Check for systemctl presence
      ansible.builtin.stat:
        path: /bin/systemctl
      register: security_sshd_security_sshd_systemctl_check
      changed_when: false
      become: true

    - name: Restart sshd via systemd (if available)
      ansible.builtin.systemd:
        name: "{{ ssh_service_name }}"
        state: restarted
      become: true
      when: security_sshd_systemctl_check.stat.exists
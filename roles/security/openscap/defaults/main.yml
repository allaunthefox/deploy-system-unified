# =============================================================================
# Audit Event Identifier: DSU-PLY-100248
# Last Updated: 2026-02-28
# =============================================================================
---
# Defaults for security/openscap - Standardized Auditing
# Note: OpenSCAP and SCAP Security Guide components are governed by the LGPLv2 License.
# See: https://github.com/OpenSCAP/openscap for full license details.

openscap_enabled: true
openscap_report_dir: "/var/lib/deploy-system/reports/openscap"
openscap_report_file: "compliance_report_{{ ansible_date_time.iso8601_basic_short }}.html"

# Profile Configuration (Standard: CIS/STIG)
# Examples: xccdf_org.ssgproject.content_profile_cis, xccdf_org.ssgproject.content_profile_stig
openscap_profile: "xccdf_org.ssgproject.content_profile_cis"

# Mandatory Compliance Gate
# If true, the deployment will FAIL if OpenSCAP score is below threshold
openscap_enforce_compliance: true
openscap_fail_threshold: 100 # 100% compliance required for Olympus-Class

# SCAP Security Guide Data Stream (Distro Specific)
openscap_ssg_datastream: >-
  {{
    '/usr/share/xml/scap/ssg/content/ssg-ubuntu2204-ds.xml' if ansible_distribution == 'Ubuntu' and ansible_distribution_version == '22.04' else
    '/usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml' if ansible_os_family == 'RedHat' else
    '/usr/share/xml/scap/ssg/content/ssg-debian12-ds.xml' if ansible_distribution == 'Debian' else
    ''
  }}

# =============================================================================
# Audit Event Identifier: DSU-PLY-100707
# Last Updated: 2026-02-28
# =============================================================================
# Goss tests for storage/backup/restic role
# Compliance: ISO 27001 ยง8.13, ISO 27040

package:
  restic:
    installed: true

command:
  restic:
    exit-status: 0
    stderr: []
    timeout: 5000
  restic_wrapper.sh:
    exit-status: 0
    stderr: []
    timeout: 5000

file:
  /etc/restic:
    exists: true
    is-directory: true
    mode: "0700"
  /var/log/restic:
    exists: true
    is-directory: true
    mode: "0700"
  /etc/restic/password:
    exists: true
    mode: "0600"
  /usr/local/bin/restic_wrapper.sh:
    exists: true
    mode: "0750"
    is-executable: true
  /etc/systemd/system/restic-backup.service:
    exists: true
  /etc/systemd/system/restic-backup.timer:
    exists: true

# =============================================================================
# Audit Event Identifier: DSU-TST-1000007
# File Type: Molecule Scenario Configuration
# Scenario: kubernetes-master
# Last Updated: 2026-02-28
# Version: 1.0
# =============================================================================
---
# molecule.yml - Ansible-Native Molecule configuration for kubernetes-master scenario
#
# This configuration uses the ansible-native approach which gives full control
# over the testing lifecycle through custom create/destroy playbooks.
#
# This scenario tests K3s installation, so it uses different settings:
#   - centos:stream9 base image
#   - k3s specific configuration
#
# Key sections:
#   - ansible.executor: Defines how playbooks are executed
#   - ansible.env: Environment variables for Ansible
#   - ansible.cfg: Ansible configuration options
#   - ansible.playbooks: Paths to create/destroy/converge/verify playbooks
#   - scenario.test_sequence: Order of test execution
#   - verifier: Verification backend (ansible-native uses ansible)
#
# Example:
#     molecule test -s kubernetes-master

ansible:
  executor:
    backend: ansible-playbook
    args:
      ansible_playbook:
        - --inventory=inventory/
  env:
    ANSIBLE_FORCE_COLOR: true
    ANSIBLE_ROLES_PATH: ${MOLECULE_PROJECT_DIRECTORY}/roles
    
  cfg:
    defaults:
      deprecation_warnings: false
      interpreter_python: auto_silent
      remote_user: root
      host_key_checking: true

  playbooks:
    create: create.yml
    destroy: destroy.yml
    converge: converge.yml

scenario:
  test_sequence:
    - create
    - converge
    - destroy

verifier:
  name: ansible

# Fail2Ban filter for Caddy JSON logs
# Matches failed logins (401) and forbidden access (403)
# Dependencies: fail2ban

[Definition]
# JSON log format: {"level":"error","ts":...,"logger":"http.log.access","msg":"handled request","request":{"remote_ip":"1.2.3.4","method":"GET","uri":"/admin"...},"status":401}
# Regex breakdown:
# Look for "remote_ip":"<HOST>"
# Look for "status":401 or 403
# Minimal match to avoid heavy processing
failregex = ^.*"remote_ip":"<HOST>",.*"status":(?:401|403).*$

ignoreregex = 

---
# Defaults for containers/caddy role
caddy_generate_config: true
caddy_acme_email: admin@owowatdis.lol

# Host ports for Caddy (rootless defaults shift to high ports unless privileged ports are enabled)
caddy_http_port: >-
  {{ (podman_rootless_enabled | default(false) | bool
      and not (podman_rootless_allow_privileged_ports | default(false) | bool))
     | ternary(8080, 80) }}
caddy_https_port: >-
  {{ (podman_rootless_enabled | default(false) | bool
      and not (podman_rootless_allow_privileged_ports | default(false) | bool))
     | ternary(8443, 443) }}
caddy_https_port_udp: "{{ caddy_https_port }}"

# Porkbun DNS Credentials (required for DNS challenge)
porkbun_api_key: "{{ vault_porkbun_api_key | default('') }}"
porkbun_secret_api_key: "{{ vault_porkbun_secret_api_key | default('') }}"

# Caddy acts as the ingress gateway and must have access to all app networks
# OR, we run it on "proxy_net" and expose app ports there.
# For simplicity with Quadlets, we can attach multiple networks to the Caddy Pod.
caddy_network: "proxy_net"
caddy_extra_networks:
  - "media_net"
  - "ops_net"
  - "monitoring_net"
  - "anubis_net"

# Crowdsec (Security Automation)
crowdsec_enable: true
crowdsec_image: docker.io/crowdsecurity/crowdsec:latest
crowdsec_firewall_bouncer_key: "{{ vault_crowdsec_firewall_bouncer_key | default('CHANGE_ME') }}"
# Crowdsec firewall bouncer pinning (supply-chain hardening)
crowdsec_firewall_bouncer_version: "0.0.34"
crowdsec_firewall_bouncer_sha256: "8b07e08fb35a90b33eb2403eb93966679b39adb42c9cd03882de66cdf19a949f"
# crowdsec_firewall_bouncer_image: docker.io/crowdsec/crowdsec-firewall-bouncer-iptables:latest (Deprecated/Missing)
crowdsec_secrets_dir: /srv/containers/secrets
# Crowdsec reads logs from Caddy, so it maps that volume
crowdsec_collections:
  - crowdsecurity/linux
  - crowdsecurity/sshd
  - crowdsecurity/caddy
  - crowdsecurity/whitelist-good-actors

# GPU Support (Inherited logic from Quadlets)
quadlet_enable_gpu_support: false

---
# Warn if common weak/default credentials are detected (non-CHANGE_ME values)
# Expected vars:
#   containers_default_password_checks: list of dicts: { name, value, bad_values }

- name: Warn on weak/default credentials (container policy)
  ansible.builtin.debug:
    msg: >-
      WARNING: {{ item.name }} is set to a weak/default value ({{ item.value }}).
      Update this value via SOPS/Vault before deploying containers.
  loop: "{{ containers_default_password_checks | default([]) }}"
  loop_control:
    label: "{{ item.name }}"
  when:
    - item.value is defined
    - item.value | string | length > 0
    - item.value in item.bad_values

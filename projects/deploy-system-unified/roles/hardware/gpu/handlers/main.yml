---
# Handlers for gpu_stack

- name: Update initramfs (placeholder)
  ansible.builtin.debug:
    msg: "Updating initramfs..."
  listen: "Update initramfs"
  notify:
    - Update Initramfs Debian
    - Update Initramfs RedHat
    - Update Initramfs Alpine

- name: Update Initramfs Debian
  ansible.builtin.command: update-initramfs -u
  become: true
  when: 
    - ansible_os_family == 'Debian'
    - not _gpu_is_container | default(false)

- name: Update Initramfs RedHat
  ansible.builtin.command: dracut --force
  become: true
  when: 
    - ansible_os_family == 'RedHat'
    - not _gpu_is_container | default(false)

- name: Update Initramfs Alpine
  ansible.builtin.command: mkinitfs
  become: true
  when: 
    - ansible_os_family == 'Alpine'
    - not _gpu_is_container | default(false)

